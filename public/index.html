<!DOCTYPE html>
<html lang="en" class="wmnds-html">
  <head>
    <meta charset="utf-8" />

    <!-- CHANGE ME -->
    <title>%REACT_APP_TITLE% - West Midlands Network</title>
    <meta name="description" content="%REACT_APP_DESCRIPTION%" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicons -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/favicon-16x16.png"
    />
    <link
      rel="manifest"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/site.webmanifest"
    />
    <link
      rel="mask-icon"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/safari-pinned-tab.svg"
      color="#3c1053"
    />
    <link
      rel="shortcut icon"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/favicon.ico"
    />
    <meta name="msapplication-TileColor" content="#3c1053" />
    <meta
      name="msapplication-config"
      content="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/favicons/browserconfig.xml"
    />
    <meta name="theme-color" content="#3c1053" />

    <!-- SEO Metadata  -->
    <meta name="title" content="%REACT_APP_TITLE%" />
    <meta name="description" content="%REACT_APP_DESCRIPTION%" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="%PUBLIC_URL%" />
    <meta property="og:title" content="%REACT_APP_TITLE%" />
    <meta property="og:description" content="%REACT_APP_DESCRIPTION%" />
    <meta
      property="og:image"
      content="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/wmn-share.png"
    />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="%PUBLIC_URL%" />
    <meta property="twitter:title" content="%REACT_APP_TITLE%" />
    <meta property="twitter:description" content="%REACT_APP_DESCRIPTION%" />
    <meta
      property="twitter:image"
      content="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/config/wmn-share.png"
    />

    <!-- WMN design system CSS -->
    <link
      rel="stylesheet"
      href="//unpkg.com/wmn-design-system@%REACT_APP_WMNDS_VERSION%/build/css/wmnds.min.css"
    />
    <style>
      .preview {
        width: 100%;
        max-width: 1100px;
        margin: 80px auto;
        border: 1px dashed rgba(0, 0, 0, 0.2);
        position: relative;
      }

      .preview::before {
        content: 'WIDGET PREVIEW';
        position: absolute;
        display: block;
        top: -18px;
        font-size: 11px;
        color: rgba(0, 0, 0, 0.5);
        letter-spacing: normal;
      }
    </style>
  </head>
  <body>
    <div class="preview wmnds-grid">
      <div class="wmnds-col-3-4" data-widget-host="habitat"></div>
    </div>
    <script>
      if (!document.querySelectorAll('.wmnds-hidden-icons').length) {
        // Ajax SVG in, SVGS are referenced in app (Icon component)
        const ajax = new XMLHttpRequest();
        ajax.open(
          'GET',
          'https://unpkg.com/wmn-design-system@1.7.3/build/img/wmnds-icons.min.svg',
          true
        );
        ajax.send();
        ajax.onload = () => {
          const div = document.createElement('div');
          div.classList.add('wmnds-hidden-icons');
          div.style.display = 'none';
          div.innerHTML = ajax.responseText;
          document.body.insertBefore(div, document.body.childNodes[0]);
        };
      }
    </script>
    <script async>
      const accordionsJS = () => {
        console.log('accordionJS');
        const accordions = document.querySelectorAll('.wmnds-accordion');

        accordions.forEach(accordion => {
          const accordionBtn = accordion.querySelector('.wmnds-accordion__summary-wrapper');

          const toggleAccordion = () => {
            if (accordion.classList.contains('wmnds-is--open')) {
              accordion.classList.remove('wmnds-is--open');
              accordionBtn.setAttribute('aria-expanded', false);
            } else {
              accordion.classList.add('wmnds-is--open');
              accordionBtn.setAttribute('aria-expanded', true);
            }
          };

          accordionBtn.addEventListener('click', toggleAccordion);
        });
      };

      const tableJS = () => {
        const tables = document.querySelectorAll('.wmnds-table');

        const getTableHeadChildren = table => {
          const tHeadChildren = table.querySelectorAll('thead tr > *'); // Using querySelectorAll as it has a fallback of an empty node list. Using children returns HTMLCollection which we can't forEach through.

          return tHeadChildren; // Return node list
        };

        const iterateTables = table => {
          const theadChildren = getTableHeadChildren(table); // Get all children from thead section

          if (!theadChildren.length) return table.classList.add('wmnds-table--without-header'); // If no headers found, add without-header class

          // Otherwise...

          // If our node list is greater than 1, then there are headers
          const tRows = table.querySelectorAll('tbody > tr'); // Get all table rows in our table body section

          return tRows.forEach(tRow => {
            const cells = tRow.querySelectorAll('td'); // Get all cells within our row

            // Loop through each cell within our row...
            cells.forEach((cell, i) => {
              const newCell = cell; // Map to new var to avoid mutating original
              const tHeadText = theadChildren[i].innerText; // Map the index of the cell to the index of the header we want as it will be in the same column of the table
              newCell.dataset.header = tHeadText; // Change the data-header on our cell to the header text so it appears on mobile
            });
          });
        };

        // START HERE
        if (tables.length) tables.forEach(iterateTables);
      };

      setTimeout(() => {
        tableJS();
        accordionsJS();
      }, 3000);
    </script>
  </body>
</html>
